# 21-dot
一个小游戏，21点扑克游戏

游戏名称：21点小游戏;
游戏作者：孙福浩;
制作时间：2016.4;
游戏用途：360实习生校招;
说明：支持在线(还没有上传)，不支持多人(没法测试故没开发)
如遇到异常请刷新重试！！

游戏不算复杂，但是也有很多细节需要注意，下面写一下我的思路。

首先我的思路是从按钮的数量入手的，这样想起来，游戏需求简单明了，不会乱套。那么有几个按钮呢？①开始游戏②发牌③抓牌④不抓牌⑤是否买保险。这五个按钮，下面详细介绍。

一：首先要初始化游戏数据
1：首先创建一个画布，定宽高
2：循环加载各种图片，包括背景和扑克牌，存在img_url对象里，这是可以在线试玩的重点
3：加载完成出现开始游戏的按钮
4：创建host 和player对象
二：开始游戏按钮
1：画出游戏背景图，画图发牌按钮:
2：设置第一张牌的位置
三：发牌按钮
1：随机画出玩家和庄主的4张牌，并保存在allindex数组中
2：判断是否庄主的第二张牌为A
3：初始化warming提示框
4：记录host 和player 的牌总点数。
5：将坐标加一定值，为拿牌做准备
四：抓牌按钮
1：玩家随机抓取一张牌，并记录
2：计算新的总点数，并判断是否爆了
3：1秒后判断庄主是否<=17点，若是则庄主也抓一张牌
4：判断庄主是否爆了
5：将发牌按钮隐藏，弹出警告框告诉玩家输赢
6：将庄主新牌加入allindex数组
五：不抓牌按钮
1：不抓牌则首先判断玩家是否买了保险
2：如果没有买保险则比较庄主和玩家大小，大的胜利
3：循环绘制allindex数组里的牌，目的是将反面牌覆盖
4：判断是否玩家还有积分，没有的话则弹出警告框
5：将抓牌按钮隐藏，弹出警告框告诉玩家输赢
六：是否买保险按钮
1：在开始按钮按下，判断是否庄主明牌有A
2：点击买保险，则将player.safe属性设为true
3：将买，不买按钮隐藏
4：将提示框隐藏
七：难点，易错点
此游戏逻辑不算难，但是难点，易错点也很多，下面总结一下。
1：计算总点数是个难点。
A可以当1和11，需要判断是当那个，11,12,13都当10.
我是如果遇到A 就判断当他当11时是否会爆，若没有爆则，看做11，否则是1。但是当11时下一次拿牌时A就会被当做10了（11>10）。所以要在计算完将A设置为1.
2：拿牌后再计算总点数是个易错点。
此时不可以用第一次发牌计算的总点数加上新牌的点数，因为以上A在抓牌	后可能充当的角色变了（为了不爆），所以需要重新调用计算总点数函数，	重新赋值
3：canvas画图也是一个易错点，尤其是画庄主的牌，因为有一张是反着的，需要用背面图片，最后需要明牌时不能只重画背着的那张牌，因为这样会将第一张牌覆盖在第二张上面，很难看，故要都重画。

很多坑都踩过了，感谢观看！
博客：www.mogublog.win
Git：github.com/sunfuhao
